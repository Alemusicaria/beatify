<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/6102a80a3f.js" crossorigin="anonymous"></script>
    <link rel="icon" href="./img/Logo_sense_fons.png">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@200&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./estil.css">
    <!--<script src="./perfil.js" defer></script> -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <title>Beatify</title>
</head>

<body>
    <header>
        <div class="menu">
            <a href="./premium/premium.html">Premium</a>
            <a href="">Asistencia</a>

            <button id="iniciarSessio">Iniciar Sessió</button>
        </div>
    </header>
    <div class="contenedor-left">
        <div class="miniMenu">
            <ul id="menu">
                <li><a href="./index.html"><img src="./img/Logo_sense_fons.png" alt="">BEATIFY</a></li>
                <li><a href="./index.html"><i class="fa-solid fa-house" style="color: rgb(255, 255, 255);"></i>INICI</a>
                </li>
                <li><i class="fa-solid fa-magnifying-glass" style="color: rgb(255, 255, 255);"></i>CERCAR</li>
            </ul>
        </div>
        <br>
        <div class="llistesUsuaris">
            <h2><i class="fa-solid fa-compact-disc"></i>Llistes Cançons</h2>
            <div id="primera">
                <h4>Crea la teva Primera Llista</h4>
                <p>Es molt fàcil</p>
                <button>Crea Llista</button>
            </div>
            <br>
            <div class="fakeFooter">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque gravida nec est non elementum.
                    In
                    sollicitudin augue nunc, sed bibendum est pretium a. Sed quam sapien, luctus sit amet libero sed
                </p>
            </div>
        </div>
    </div>
    <div class="contenedor-right">
        <h2>Lo més escoltat</h2>
        <div id="taula">
        </div>
        <p>&copy; 2024 Beatify. Tots els drets reservats.</p>

    </div>

    <footer>
        <div class="reproductor-musica">
            <div class="reproductor-contenido">
                <div class="reproductor-info">
                    <img src="" alt="portada" id="reproductor-img">
                    <div class="info-text">
                        <h4 id="reproductor-title"></h4>
                        <p id="reproductor-artist"></p>
                    </div>
                </div>
                <div class="music-player-container">
                    <div class="controls-music-container">
                        <div class="progress-song-container">
                            <div class="progress-bar">
                                <span class="progress"></span>
                            </div>
                        </div>
                        <div class="time-container">
                            <span class="time-left" id="CurrentSongTime"></span>
                            <span class="time-left" id="SongLength"></span>
                        </div>
                    </div>
                    <audio controls preload="metadata" src="" id="reproductor-audio"></audio>
                    <div class="main-song-controls">
                        <img src="./img/simbols/Backward.svg" alt="" class="icon" id="Back10">
                        <img src="./img/simbols/Play.svg" alt="" class="icon" id="PlayPause">
                        <img src="./img/simbols/Forward.svg" alt="" class="icon" id="Plus10">
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <script>
        function transferirInformacion(event) {
            // Obtener el conjunto de elementos padre del icono clicado
            var songsDiv = event.target.closest('.songs');

            // Verificar si se encontró el conjunto de elementos
            if (songsDiv) {
                var imgSrc = songsDiv.querySelector('img.portada').src;
                var songTitle = songsDiv.querySelector('h4').innerText;
                var artistInfo = songsDiv.querySelector('p').innerText;

                // Asignar la información al reproductor de música
                var reproductorImg = document.getElementById('reproductor-img');
                var reproductorTitle = document.getElementById('reproductor-title');
                var reproductorArtist = document.getElementById('reproductor-artist');
                var reproductorAudio = document.getElementById('reproductor-audio');

                reproductorImg.src = imgSrc;
                reproductorTitle.innerText = songTitle;
                reproductorArtist.innerText = artistInfo;
                reproductorAudio.src = "./musica/mp3/" + songTitle + ".mp3";
                reproductorAudio.play();
            }
        }

        // Agregar evento de clic a todos los elementos con la clase 'icono'
        var iconos = document.querySelectorAll('.icono');
        iconos.forEach(function (icono) {
            icono.addEventListener('click', transferirInformacion);
        });

        document.getElementById('iniciarSessio').addEventListener('click', function () {
            // Cambia 'tu_pagina.html' por la ruta correcta de tu página HTML vinculada
            window.location.href = './login/login.html';
        });








        function carregarCancons() {
            // Fer una crida AJAX per obtenir les cançons de la base de dades
            $.ajax({
                url: 'conexio.php',
                method: 'GET',
                success: function (data) {
                    // Parsejar les dades rebudes (assumeix que la resposta és un array JSON)
                    var cancons = JSON.parse(data);

                    // Seleccioneu l'element #taula per afegir-hi els div de les cançons
                    var taula = $('#taula');

                    // Itera sobre les cançons i afegeix-les a la pàgina
                    $.each(cancons, function (index, canco) {
                        // Crear un nou element div amb les classes necessàries
                        var novaCancoDiv = $('<div class="songs"></div>');

                        // Afegir les etiquetes d'imatge, icono, h4 i p
                        novaCancoDiv.append('<img src="musica/portades/' + canco.Img + '" alt="' + canco.Titol + '" class="portada">');
                        novaCancoDiv.append('<img src="./img/playImg.png" alt="icon" class="icono">');
                        novaCancoDiv.append('<h4>' + canco.Titol + '</h4>');

                        // Afegir el nou div a l'element #taula
                        taula.append(novaCancoDiv);
                    });
                },
                error: function (error) {
                    console.log('Error en carregar les cançons:', error);
                }
            });
        }

        // Cridar la funció per carregar les cançons quan la pàgina estigui carregada
        $(document).ready(function () {
            carregarCancons();
        });
    </script>
    <script src="code.js"></script>
</body>

</html>